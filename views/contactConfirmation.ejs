<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contact Form</title>
</head>

<body>
    <h1>Contact Us</h1>

    <% if (submitted) { %>
        <!-- Display confirmation message if the form is submitted -->
        <p>Thank you for contacting us, <%= formData.name %>! We have received your message and will get back to you
                soon.</p>
        <% } else { %>
            <!-- Display the contact form if it's not submitted -->
            <form id="contactForm">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required>

                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>

                <label for="message">Message:</label>
                <textarea id="message" name="message" required></textarea>

                <button type="button" onclick="submitForm()">Submit</button>
            </form>

            <script src="/Controllers/socket.js"></script>
            <script>
                const socket = io();

                // Listen for a newContactForm event
                socket.on('newContactForm', () => {
                    // Set a flag to indicate that the form is submitted
                    document.getElementById('contactForm').style.display = 'none';
                    document.getElementById('confirmationMessage').style.display = 'block';
                });

                // Function to submit the form
                function submitForm() {
                    const name = document.getElementById('name').value;
                    const email = document.getElementById('email').value;
                    const message = document.getElementById('message').value;

                    // Assume you have a function to send the form data to the server
                    // (You need to implement this function in your client-side code)
                    sendFormToServer({ name, email, message });
                }

                // Function to send the form data to the server
                function sendFormToServer(formData) {
                    // Send the form data to the server using an AJAX request
                    // (You need to implement this part in your client-side code)
                    // For simplicity, you can use the fetch API or another AJAX library
                    fetch('http://localhost:5000/sendEmailContact', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(formData),
                    })
                        .then(response => response.json())
                        .then(data => {
                            console.log('Form submitted successfully:', data);
                            // You can handle the response as needed
                        })
                        .catch(error => {
                            console.error('Error submitting form:', error);
                        });
                }
            </script>

            <% } %>

                <div id="confirmationMessage" style="display: none;">
                    <!-- This div will be displayed when the form is submitted -->
                    <p>Thank you for contacting us! We have received your message and will get back to you soon.</p>
                </div>
</body>

</html>